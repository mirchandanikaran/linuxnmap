<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Nmap Suite</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/socket.io-client/dist/socket.io.min.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
  <style>
    @media (min-width: 992px) {
      .sidebar { position: fixed; top:56px; left:0; bottom:0; width:220px; overflow:auto; }
      .content-area { margin-left:220px; }
    }
    @media (max-width:991px) {
      .sidebar { position:relative; width:100%; }
      .content-area { margin-left:0; }
    }
  </style>
</head>
<body class="light-mode">
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container-fluid px-3">
    <a class="navbar-brand" href="{{ url_for('dashboard.index') }}">Nmap Suite</a>
    <div class="d-flex align-items-center ms-auto">
      {% if current_user.is_authenticated %}
        <small class="text-light me-3">Logged in as {{ current_user.username }}</small>
        <a href="{{ url_for('auth.logout') }}" class="btn btn-outline-light btn-sm">Logout</a>
      {% endif %}
    </div>
  </div>
</nav>

<aside class="sidebar p-3 bg-light">
  <h6 class="text-uppercase">Menu</h6>
  <ul class="nav flex-column mb-3">
    <li class="nav-item"><a class="nav-link" href="{{ url_for('dashboard.index') }}">Dashboard</a></li>
    <li class="nav-item"><a class="nav-link" href="{{ url_for('terminal.view_terminal') }}">Live Terminal</a></li>
    <li class="nav-item"><a class="nav-link" href="{{ url_for('history.view_history') }}">Scan History</a></li>
  </ul>
  <hr>
  <button id="themeToggle" class="btn btn-sm btn-secondary w-100">üåô Dark Mode</button>
</aside>

<main class="content-area p-4">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  {% block content %}{% endblock %}
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="{{ url_for('static', filename='main.js') }}"></script>
<script>
(function(){
  const toggle = document.getElementById('themeToggle');
  const saved = localStorage.getItem('theme');
  if (saved) {
    document.body.className = saved;
    toggle.innerText = saved === 'dark-mode' ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
  }
  toggle.addEventListener('click', () => {
    const isLight = document.body.classList.contains('light-mode');
    document.body.className = isLight ? 'dark-mode' : 'light-mode';
    localStorage.setItem('theme', document.body.className);
    toggle.innerText = isLight ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
  });
})();
</script>
</body>
</html>
